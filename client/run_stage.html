<template name="runStage">
<div>
{{> starterDialog}}
{{> finisherDialog}}

<h1>RaceT<sub>i</sub>me Timing {{stage.name}}</h1>
<button class=" btn openStage">Open Stage</button>
<button class=" btn closeStage">Close Stage</button>

<h3>Pick Next</h3>
	{{>stageFindNext}}
<h3><i class="icon-road"/> Ready to start</h3>
	{{>stageReady}}
<h3><i class="icon-time"/> Running now</h3>
	{{>stageRunning}}
<h3><i class="icon-wrench"/> Confirm score</h3>
	{{>stageScore}}
<h3><i class="icon-list"/> Done</h3>
	{{>stageDone}}
</div>
</template>

<template name="stageFindNext">
<div>
	{{#each pendingEntrants}}
		{{>entrantLabel entrant}}
	{{/each}}
</div>
</template>


<template name="stageReady">
	{{#each entrants}} {{>entrantLabel entrant}}{{/each}}
	{{#if next.score}}
	{{#with next}}
<table>
	<tr>
		<td>{{>entrantLabel entrant}}</td>
		<td><button class=" btn btn-danger getReady"><i class="icon-time"/> Starting...</button></td>
		<td><button class=" btn dequeue">DeQueue</button></td>
		<td><button class=" btn ">DNS</button></td>
		<td><button class=" btn ">Class Changed</button></td>
		<td><button class=" btn ">Notes</button></td>
	</tr>
</table>
{{/with}}
{{/if}}
</template>


<template name="stageRunning">
<table>
	{{#each entrantScores}}
		<tr>
		<td>{{>entrantLabel entrant}}</td>
		<td><button class=" btn btn-danger getReady"><i class="icon-time"/>Finishing...</button></td>
		</tr>
	{{/each}}
</table>
</template>





<template name="starterDialog">
{{#if show}}
<div class="mask"/>
<div class="modal">
	<div class="modal-header">
		<button type="button" class="close done">&times;</button>
	</div>

	<div class="modal-body">
		{{#each entrantScores}}
		<div class="invite-row">
		<h3>Starter Ready...</h3>
		<h1>0:00:00{{>entrantLabel entrant}}</h1>
			<a href="#" class="btn btn-primary now"><i class="icon-time" />Go</a>
			<a href="#" class="btn cancel done">Cancel Start</a>
		</div>
		{{/each}}
	</div>

	<div class="modal-footer">
		<a href="#" class="btn btn-primary notTimer">I'm not a Timer!</a>
	</div>
</div>
{{/if}}
</template>



<template name="finisherDialog">
{{#if show}}
<div class="mask"/>
<div class="modal">
	<div class="modal-header">
		<button type="button" class="close done">&times;</button>
	</div>

	<div class="modal-body">
		{{#each entrantScores}}
		<div class="invite-row">
		<h3>Starter Ready...</h3>
		<h1>0:00:00{{>entrantLabel entrant}}</h1>
			<a href="#" class="btn btn-primary now"><i class="icon-time" />Stop</a>
			<a href="#" class="btn cancel done">Later</a>
		</div>
		{{/each}}
	</div>

	<div class="modal-footer">
		<a href="#" class="btn btn-primary notTimer">I'm not a Timer!</a>
	</div>
</div>
{{/if}}
</template>



<template name="stageScore">
<!-- Main editing form of stage result  -->
	{{#each entrantScores}}
		{{>entrantLabel entrant}}
	{{/each}}
<ul>
	{{#with next}}
	<li>
		{{>entrantLabel entrant}}
		Cones {{score.penalties.cones}} <button class=" btn ">+</button><button class=" btn ">-</button>
		Gates {{score.penalties.gates}} <button class=" btn ">+</button><button class=" btn ">-</button>
		<select>
		<option>Ok Maybe make this a toggle button set (touch screens!)</option>
		<option>WD</option>
		<option>DNS</option>
		<option>DNF</option>
		</select>
		<textarea rows="3">{{notes}} make this collapse in some way</textarea>
		<input type="text" placeholder="Manual time overide ... SHow when no Start Stop times OR they are all struck out!">
		<table>
			<thead><td>Start</td><td>Stop</td></thead>
			<tbody></tbody>
		{{#each rawScores}}
			<tr><td>{{#if start.trashed}}<del>{{/if}}{{start.time}}{{#if start.trashed}}</del>{{/if}}</td>
			<td>{{stop.time}}</td></tr>
		{{/each}}
		</tbody>
		<tfoot>
			<tr><td>Avg time{{start.time}}</td>
			<td>Avg time{{stop.time}}</td></tr>
		</tfoot>
		</table>

		<button class=" btn btn-primary">Save</button>
	</li>
	{{/with}}
</ul>
</template>




<template name="stageDone">
<table>
	{{#each entrantScores}}
		<tr>
		<td>{{>entrantLabel entrant}}</td>
		<td>{{score.score}}</td>
		<td><span class="number badge">{{score.code}}</span></td>
		<td>
			{{#each penaltyList score.penalties}}
			<span class="number badge">{{key}} {{val}}</span>
			{{/each}}
		</td>
		<td><a><i class="icon-wrench"/></a></td>
		</tr>
	{{/each}}
</table>
</template>